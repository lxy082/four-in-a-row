# Gravity 3D Connect-4（重力三维四子棋）

## 游戏规则
- 棋盘为 5×5×5 的三维立方体，坐标 (x, y, z)，其中 z=0 为最底层。
- 重力方向固定向 -z。
- 落子采用“柱子模式”：玩家每回合只选择一个底面柱子 (x, y)，棋子会自动落到该柱子最低空位。
- 操作方式：先点击柱子进行选择，再点击【落子】按钮确认，才会真正落子。
- 若该柱子 5 个高度已满，则该步非法，提示“该位置已满，请重新选择”，轮到同一玩家重新下。
- 棋子为三维球体。
- 任意方向连续 4 子即胜（包括 x、y、z 轴方向，平面内斜线，以及三维空间斜线）。
- 若棋盘 125 格全部填满且无人达成 4 连，则平局。
- 模式：PVP 或人机对战（支持 AI 先手/后手）。

## 本地运行
```bash
npm install
npm run dev
```

## 构建与本地静态启动
```bash
npm run build
npx http-server dist -p 8000
```
> 也可使用 `python -m http.server 8000` 在 `dist/` 下启动（无需 npm）。

## 部署建议
- **GitHub Pages**：使用 `npm run build` 生成 `dist/`，将其发布到 `gh-pages` 分支。
- **Vercel/Netlify**：构建命令 `npm run build`，输出目录 `dist`。

## AI 设计说明
AI 采用 Minimax + AlphaBeta + 迭代加深，并加入“人类感”策略：
1. **立即胜利**：存在一步直胜则马上下。
2. **立即防守**：若对手有一步直胜威胁，优先封堵。
3. **中心偏好**：越接近中心柱子得分越高。
4. **造威胁/避免送杀**：搜索中倾向制造下一回合双威胁，并避免给对手直接胜利。

### 评估函数核心思想
- 预计算所有“连续 4 格线段”。
- 对每条线段：
  - 若同时出现双方棋子 → 记 0 分（无潜力）。
  - 若只出现己方棋子 k 个 → 加分（k 越大加分越高）。
  - 若只出现对手棋子 k 个 → 减分（k 越大惩罚越高）。
- 额外叠加“中心权重”，越接近 (2,2,2) 得分越高。

### 难度差异
- **Easy**：仅进行浅层搜索并在评分最高的前 K 个中随机选择，思考时间 ≤ 80ms。
- **Medium**：迭代加深 + AlphaBeta，深度约 2~4，思考时间 ≤ 500ms。
- **Hard**：迭代加深 + AlphaBeta，深度约 4~6，思考时间 ≤ 1200ms，并强化走子排序。

## 测试
```bash
npm run test
```
